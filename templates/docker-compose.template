version: '3.8'

services:
{{#tools}}
  {{tool_name}}-{{target_name}}:
    build:
      context: ../../
      dockerfile: dockerfiles/Dockerfile.{{tool_name}}.{{target_name}}
    container_name: {{tool_name}}-{{target_name}}
    restart: unless-stopped
    environment:
      - RUN_NUMBER=${RUN_NUMBER:-1}
      - HTTPS_PROXY=${HTTPS_PROXY}
      - LLM_API_KEY=${LLM_API_KEY}
    volumes:
      - ../../results:/opt/fuzzing/results
      - ../../logs:/opt/fuzzing/logs
      - {{target_source_path}}:/opt/fuzzing/targets/{{target_name}}:ro
    networks:
      - fuzzing-network
    command: /opt/fuzzing/run_24h.sh
    
{{/tools}}

networks:
  fuzzing-network:
    driver: bridge

volumes:
  results:
  logs:
