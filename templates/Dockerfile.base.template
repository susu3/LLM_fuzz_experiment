FROM {{base_image}}

# 设置环境变量
ENV DEBIAN_FRONTEND=noninteractive
ENV TZ=Asia/Shanghai
ENV HTTPS_PROXY=http://hwcloud-hk.ring0.me:48527
ENV LLM_API_KEY=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

# 安装基础依赖
RUN apt-get update && apt-get install -y \
    build-essential \
    gcc \
    g++ \
    make \
    cmake \
    git \
    wget \
    curl \
    python3 \
    python3-pip \
    libtool \
    autoconf \
    automake \
    bison \
    libglib2.0-dev \
    libpixman-1-dev \
    clang \
    llvm \
    pkg-config \
    {{dependencies_placeholder}} \
    && rm -rf /var/lib/apt/lists/*

# 创建工作目录
WORKDIR /opt/fuzzing
RUN mkdir -p /opt/fuzzing/tools /opt/fuzzing/targets /opt/fuzzing/results

# 设置基础用户
RUN useradd -m -s /bin/bash fuzzer
